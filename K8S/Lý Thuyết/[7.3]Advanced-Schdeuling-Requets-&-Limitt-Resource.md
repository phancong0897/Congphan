# XÃ¡c Ä‘á»‹nh cÃ¡c giÃ¡ trá»‹ Requests vÃ  Limits resources cho containers

Khi Kubernetes lÃªn lá»‹ch cho Pod ( tá»©c lÃ  ra quyáº¿t Ä‘á»‹nh deploy pods vá»›i tÃ i nguyÃªn nhÆ° tháº¿ nÃ o vÃ  deploy trÃªn node nÃ o náº¿u lÃ  cá»¥m kubernetes cluster), thÃ¬ Ä‘iá»u quan trá»ng lÃ  cÃ¡c container cÃ³ Ä‘á»§ tÃ i nguyÃªn Ä‘á»ƒ hoáº¡t Ä‘á»™ng hiá»‡u quáº£. Náº¿u báº¡n lÃªn lá»‹ch cho má»™t á»©ng dá»¥ng lá»›n trÃªn má»™t node cÃ³ tÃ i nguyÃªn háº¡n cháº¿, thÃ¬ node Ä‘Ã³ cÃ³ thá»ƒ háº¿t bá»™ nhá»› hoáº·c tÃ i nguyÃªn CPU vÃ  má»i thá»© ngá»«ng hoáº¡t Ä‘á»™ng! Ngay cáº£ trong quÃ¡ trÃ¬nh váº­n hÃ nh, cÃ³ ráº¥t nhiá»u nguyÃªn nhÃ¢n nhÆ° cáº¥u hÃ¬nh khÃ´ng tá»‘t, do lá»—i code,.. cÃ³ thá»ƒ dáº«n Ä‘áº¿n viá»‡c á»©ng dá»¥ng cá»§a báº¡n sá»­ dá»¥ng tÃ i nguyÃªn hÆ¡n má»©c cáº§n thiáº¿t. VÃ  dÃ¹ lá»—i xáº£y ra vÃ¬ nguyÃªn nhÃ¢n gÃ¬, chÃºng ta cÅ©ng cáº§n tÃ¬m ra cÃ¡c giáº£i phÃ¡p Ä‘á»ƒ kiá»ƒm soÃ¡t chÃºng má»™t cÃ¡ch tá»‘t nháº¥t cÃ³ thá»ƒ. Má»™t trong nhá»¯ng giáº£i phÃ¡p Ä‘á»ƒ báº¡n cÃ³ thá»ƒ giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» lÃ  báº±ng cÃ¡ch chá»‰ Ä‘á»‹nh cÃ¡c Request (yÃªu cáº§u) vÃ  Limit (giá»›i háº¡n) tÃ i nguyÃªn.

### Request vÃ  Limit resource lÃ  gÃ¬ vÃ  hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?

- Requests: Báº£o Ä‘áº£m vá» lÆ°á»£ng tÃ i nguyÃªn mÃ  má»™t pod trong workload sáº½ Ä‘Æ°á»£c cáº¥p. Máº·c Ä‘á»‹nh cÃ¡c thuá»™c tÃ­nh nÃ y sáº½ Ä‘á»ƒ trá»‘ng hoáº·c láº¥y theo yÃªu cáº§u máº·c Ä‘á»‹nh cá»§a namespace (sáº½ Ä‘Æ°á»£c Ä‘á» cáº­p sau). TÃ i nguyÃªn request tá»‘i Ä‘a pháº£i nhá» hÆ¡n lÆ°á»£ng tÃ i nguyÃªn mÃ  má»™t server máº¡nh nháº¥t trong cluster cÃ³ thá»ƒ táº£i Ä‘Æ°á»£c.
    
    - VÃ­ dá»¥: request: 100mCPU, 256MiB RAM mang Ã½ nghÄ©a báº¡n sáº½ luÃ´n Ä‘áº£m báº£o ráº±ng k8s sáº½ cáº¥p cho báº¡n Ã­t nháº¥t 100 mCPU vÃ  256MiB RAM. Há»‡ thá»‘ng sáº½ chá»‰ deploy pod cá»§a báº¡n trÃªn node cÃ³ Ä‘á»§ sá»‘ lÆ°á»£ng tÃ i nguyÃªn nhÆ° trÃªn. Táº¥t nhiÃªn kube-scheduler cÃ³ Ä‘Ã¡nh dáº¥u lÆ°á»£ng tÃ i nguyÃªn nÃ y Ä‘Ã£ bá»‹ chiáº¿m dá»¥ng.
    
    - Giáº£ sá»­ báº¡n cÃ³ 2 node, node 1 cÃ³ 2 vCore vÃ  8GiB RAM, node 2 cÃ³ 4 vCore 16GiB RAM, náº¿u workload cá»§a báº¡n yÃªu cáº§u request: 2500mCPU, 8GiB RAM thÃ¬ server sáº½ chá»‰ deploy pod cá»§a workload nÃ y vÃ o node 2.
    
    - Trong trÆ°á»ng há»£p cÅ©ng vá»›i cáº¥u hÃ¬nh trÃªn mÃ  báº¡n yÃªu cáº§u tÃ i nguyÃªn request: 4000mCPU, 8GiB RAM, sáº½ khÃ´ng cÃ³ pod nÃ o Ä‘Æ°á»£c deploy cáº£.

    - Pods sáº½ nháº­n Ä‘Æ°á»£c sá»‘ lÆ°á»£ng bá»™ nhá»› mÃ  nÃ³ yÃªu cáº§u. Náº¿u vÆ°á»£t quÃ¡ yÃªu cáº§u bá»™ nhá»›, bá»™ nhá»› cÃ³ thá»ƒ bá»‹ kill (loáº¡i bá») náº¿u má»™t Pod khÃ¡c náº£y sinh nhu cáº§u vá»›i bá»™ nhá»› nÃ y. Pods chá»‰ bá»‹ loáº¡i bá» khi sá»­ dá»¥ng Ã­t bá»™ nhá»› hÆ¡n yÃªu cáº§u náº¿u há»‡ thá»‘ng quan trá»ng hoáº·c workload Æ°u tiÃªn cáº§n bá»™ nhá»›.

    - TÆ°Æ¡ng tá»±, container trong Pod Ä‘Æ°á»£c phÃ¢n bá»• sá»‘ lÆ°á»£ng CPU mÃ  nÃ³ yÃªu cáº§u, náº¿u cÃ³ sáºµn. CPU cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n bá»• cÃ¡c chu ká»³ CPU bá»• sung náº¿u cÃ¡c Pods hoáº·c cÃ´ng viá»‡c khÃ¡c khÃ´ng cáº§n tá»›i tÃ i nguyÃªn cÃ³ sáºµn nÃ y.

    - LÆ°u Ã½: náº¿u tá»•ng sá»‘ yÃªu cáº§u Pod khÃ´ng cÃ³ sáºµn trÃªn má»™t node , thÃ¬ Pod sáº½ váº«n á»Ÿ tráº¡ng thÃ¡i â€œPending stateâ€ (Äang chá» xá»­ lÃ½, tá»©c lÃ  khÃ´ng cháº¡y) cho Ä‘áº¿n khi cÃ¡c tÃ i nguyÃªn nÃ y kháº£ dá»¥ng.

- Limits: Giá»›i háº¡n lÆ°á»£ng tÃ i nguyÃªn mÃ  má»™t pod trong workload sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng
    
    - VÃ­ dá»¥: limits: 1000mCPU, 2GiB RAM mang Ã½ nghÄ©a ráº±ng báº¡n chá»‰ cÃ³ thá»ƒ dÃ¹ng tá»‘i Ä‘a 1 CPU vÃ  2GiB RAM.

    - Giá»›i háº¡n tÃ i nguyÃªn giÃºp bá»™ láº­p lá»‹ch Kubernetes xá»­ lÃ½ tá»‘t hÆ¡n sá»± tranh cháº¥p tÃ i nguyÃªn. Khi má»™t Pod sá»­ dá»¥ng nhiá»u bá»™ nhá»› hÆ¡n giá»›i háº¡n cá»§a nÃ³, cÃ¡c tiáº¿n trÃ¬nh cá»§a nÃ³ sáº½ bá»‹ kernel loáº¡i bá» (kill) Ä‘á»ƒ báº£o vá»‡ cÃ¡c á»©ng dá»¥ng khÃ¡c trong cluster. Pods sáº½ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh CPU khi vÆ°á»£t quÃ¡ giá»›i háº¡n CPU cá»§a chÃºng.
    
    - Náº¿u khÃ´ng cÃ³ giá»›i háº¡n nÃ o Ä‘Æ°á»£c Ä‘áº·t, thÃ¬ cÃ¡c pods cÃ³ thá»ƒ sá»­ dá»¥ng bá»™ nhá»› vÃ  CPU dÆ° thá»«a khi kháº£ dá»¥ng.
    
    - Náº¿u báº¡n chá»‰ Ä‘á»‹nh giá»›i háº¡n CPU cho container nhÆ°ng khÃ´ng chá»‰ Ä‘á»‹nh yÃªu cáº§u CPU, Kubernetes sáº½ tá»± Ä‘á»™ng chá»‰ Ä‘á»‹nh yÃªu cáº§u CPU phÃ¹ há»£p vá»›i giá»›i háº¡n. TÆ°Æ¡ng tá»±, náº¿u má»™t container chá»‰ Ä‘á»‹nh giá»›i háº¡n bá»™ nhá»› cá»§a riÃªng nÃ³, nhÆ°ng khÃ´ng chá»‰ Ä‘á»‹nh yÃªu cáº§u bá»™ nhá»›, Kubernetes sáº½ tá»± Ä‘á»™ng gÃ¡n má»™t yÃªu cáº§u bá»™ nhá»› phÃ¹ há»£p vá»›i giá»›i háº¡n.
    
    - LÆ°u Ã½: Äiá»u quan trá»ng cáº§n nhá»› lÃ  Limits khÃ´ng bao giá» Ä‘Æ°á»£c tháº¥p hÆ¡n Request. Báº¡n cÃ³ thá»ƒ thá»­ Ä‘áº·t cÃ¡c giÃ¡ trá»‹ nhÆ° váº­y, Kubernetes sáº½ bÃ¡o lá»—i vÃ  khÃ´ng cho phÃ©p báº¡n cháº¡y container cá»§a mÃ¬nh Ä‘Ã¢u ğŸ˜„

- Má»™t Pod lÃ  má»™t khÃ¡i niá»‡m trá»«u tÆ°á»£ng cá»§a Kubernetes, Ä‘áº¡i diá»‡n cho má»™t nhÃ³m gá»“m má»™t hoáº·c nhiá»u á»©ng dá»¥ng containers (vÃ­ dá»¥ nhÆ° Docker hoáº·c rkt) vÃ  má»™t sá»‘ tÃ i nguyÃªn Ä‘Æ°á»£c chia sáº» cho cÃ¡c containers Ä‘Ã³. Äáº¿n lÆ°á»£t mÃ¬nh, cÃ¡c pod cÃ³ thá»ƒ Ä‘Æ°á»£c triá»ƒn khai vÃ  quáº£n lÃ½ trÃªn cÃ¡c node. Má»—i node trong má»™t cá»¥m Kubernetes cÃ³ má»™t lÆ°á»£ng bá»™ nhá»› (RAM) vÃ  CPU Ä‘Æ°á»£c phÃ¢n bá»• cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cháº¡y cÃ¡c pods.

- CÃ¡c yÃªu cáº§u vÃ  giá»›i háº¡n tÃ i nguyÃªn lÃ  cÃ¡c tham sá»‘ tÃ¹y chá»n Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh á»Ÿ cáº¥p Ä‘á»™ cá»§a container. Kubernetes tÃ­nh toÃ¡n má»™t yÃªu cáº§u vÃ  giá»›i háº¡n cá»§a Pod báº±ng giÃ¡ trá»‹ tá»•ng há»£p yÃªu cáº§u vÃ  giá»›i háº¡n trÃªn táº¥t cáº£ cÃ¡c container cá»§a nÃ³. Kubernetes sau Ä‘Ã³ sáº½ sá»­ dá»¥ng cÃ¡c tham sá»‘ nÃ y Ä‘á»ƒ lÃªn lá»‹ch vÃ  quyáº¿t Ä‘á»‹nh phÃ¢n bá»• tÃ i nguyÃªn cho pods.
